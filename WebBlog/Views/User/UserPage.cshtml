@model WebBlog.Models.User

@{
    ViewData["Title"] = "UserPage";
}

<h1>User Dashboard</h1>

<h2>Profile Information</h2>
<p><strong>First Name:</strong> @Model.FirstName</p>
<p><strong>Last Name:</strong> @Model.LastName</p>
<p><strong>Email:</strong> @Model.Email</p>

<h2>Blog Posts</h2>
@if (Model.BlogPosts.Any())
{
    foreach (var post in Model.BlogPosts)
    {
        <h3>@post.Title</h3>
        <p>@post.Content</p>
        <p>Last Edit: @post.CreatedAt.ToString("MMMM dd, yyyy 'at' hh:mm tt")</p>

        <h4>Comments:</h4>
        @foreach (var comment in post.Comments)
        {
            <div>
                <p>@comment.Content</p>
                <p>Posted by: @comment.User.FirstName @comment.User.LastName (@comment.CreatedAt.ToString("MMMM dd, yyyy 'at' hh:mm tt"))</p>
                @if (comment.UserId == Model.Id) 
                {
                    <form asp-action="DeleteComment" asp-controller="User" method="post">
                        <input type="hidden" name="commentId" value="@comment.Id" />
                        <button type="submit" class="btn btn-danger">Delete</button>
                    </form>
                }
            </div>
        }
        <form asp-action="AddComment" asp-controller="User" method="post">
            <input type="hidden" name="postId" value="@post.Id" />
            <div class="form-group">
                <label for="commentContent">Add a comment:</label>
                <textarea class="form-control" id="commentContent" name="content" rows="3"></textarea>
            </div>
            <button type="submit" class="btn btn-primary">Submit</button>
        </form>
    }
}
else
{
    <p>No blog posts found.</p>
}
